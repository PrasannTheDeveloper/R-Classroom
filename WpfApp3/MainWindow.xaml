<Window x:Class="WpfApp3.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:WpfApp3"
        xmlns:wpf="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        mc:Ignorable="d"
        Title="R Classroom" Height="800" Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="Transparent"
        AllowsTransparency="True"
        WindowStyle="None"
        ResizeMode="CanResizeWithGrip">
    <Window.Resources>
        <!-- Anime Classroom Color Palette - Light Theme -->
        <Color x:Key="LightCreamBackground">#FFF5F1E8</Color>
        <Color x:Key="LightPaperWhite">#FFFFF8F0</Color>
        <Color x:Key="LightMintGreen">#FFB8E6B8</Color>
        <Color x:Key="LightLavender">#FFE6E6FA</Color>
        <Color x:Key="LightSkyBlue">#FF87CEEB</Color>
        <Color x:Key="LightWarmBrown">#FF8B4513</Color>
        <Color x:Key="LightStickyNoteYellow">#FFFFEB9C</Color>
        <Color x:Key="LightSageGreen">#FF9CAF88</Color>
        <Color x:Key="LightSoftOrange">#FFFFD4A3</Color>
        <Color x:Key="LightChalkboard">#FFB3E5FC</Color>
        <Color x:Key="LightChalkWhite">#FFFFFFFF</Color>
        <Color x:Key="LightSoftBlue">#FF5C6BC0</Color>
        <Color x:Key="LightPencilYellow">#FFF9C4B0</Color>

        <!-- Anime Classroom Color Palette - Dark Theme -->
        <Color x:Key="DarkCreamBackground">#FF1E1E1E</Color>
        <Color x:Key="DarkPaperWhite">#FF2D2D2D</Color>
        <Color x:Key="DarkMintGreen">#FF4CAF50</Color>
        <Color x:Key="DarkLavender">#FF9C27B0</Color>
        <Color x:Key="DarkSkyBlue">#FF2196F3</Color>
        <Color x:Key="DarkWarmBrown">#FF795548</Color>
        <Color x:Key="DarkStickyNoteYellow">#FF3E2723</Color>
        <Color x:Key="DarkSageGreen">#FF388E3C</Color>
        <Color x:Key="DarkSoftOrange">#FFFF9800</Color>
        <Color x:Key="DarkChalkboard">#FF424242</Color>
        <Color x:Key="DarkChalkWhite">#FFFFFFFF</Color>
        <Color x:Key="DarkSoftBlue">#FF03A9F4</Color>
        <Color x:Key="DarkPencilYellow">#FFFFC107</Color>

        <!-- Semi-transparent colors using 8-digit ARGB format -->
        <Color x:Key="SemiTransparentWhite">#AAFFFFFF</Color>
        <Color x:Key="SemiTransparentStickyNoteYellow">#CCFFEB9C</Color>
        <Color x:Key="SemiTransparentLavender">#CCE6E6FA</Color>
        <Color x:Key="SemiTransparentCream">#CCF5F1E8</Color>

        <!-- Brushes for Light Theme -->
        <SolidColorBrush x:Key="LightCreamBackgroundBrush" Color="{StaticResource LightCreamBackground}"/>
        <SolidColorBrush x:Key="LightPaperWhiteBrush" Color="{StaticResource LightPaperWhite}"/>
        <SolidColorBrush x:Key="LightMintGreenBrush" Color="{StaticResource LightMintGreen}"/>
        <SolidColorBrush x:Key="LightLavenderBrush" Color="{StaticResource LightLavender}"/>
        <SolidColorBrush x:Key="LightSkyBlueBrush" Color="{StaticResource LightSkyBlue}"/>
        <SolidColorBrush x:Key="LightWarmBrownBrush" Color="{StaticResource LightWarmBrown}"/>
        <SolidColorBrush x:Key="LightStickyNoteYellowBrush" Color="{StaticResource LightStickyNoteYellow}"/>
        <SolidColorBrush x:Key="LightSageGreenBrush" Color="{StaticResource LightSageGreen}"/>
        <SolidColorBrush x:Key="LightSoftOrangeBrush" Color="{StaticResource LightSoftOrange}"/>
        <SolidColorBrush x:Key="LightChalkboardBrush" Color="{StaticResource LightChalkboard}"/>
        <SolidColorBrush x:Key="LightChalkWhiteBrush" Color="{StaticResource LightChalkWhite}"/>
        <SolidColorBrush x:Key="LightSoftBlueBrush" Color="{StaticResource LightSoftBlue}"/>
        <SolidColorBrush x:Key="LightPencilYellowBrush" Color="{StaticResource LightPencilYellow}"/>

        <!-- Brushes for Dark Theme -->
        <SolidColorBrush x:Key="DarkCreamBackgroundBrush" Color="{StaticResource DarkCreamBackground}"/>
        <SolidColorBrush x:Key="DarkPaperWhiteBrush" Color="{StaticResource DarkPaperWhite}"/>
        <SolidColorBrush x:Key="DarkMintGreenBrush" Color="{StaticResource DarkMintGreen}"/>
        <SolidColorBrush x:Key="DarkLavenderBrush" Color="{StaticResource DarkLavender}"/>
        <SolidColorBrush x:Key="DarkSkyBlueBrush" Color="{StaticResource DarkSkyBlue}"/>
        <SolidColorBrush x:Key="DarkWarmBrownBrush" Color="{StaticResource DarkWarmBrown}"/>
        <SolidColorBrush x:Key="DarkStickyNoteYellowBrush" Color="{StaticResource DarkStickyNoteYellow}"/>
        <SolidColorBrush x:Key="DarkSageGreenBrush" Color="{StaticResource DarkSageGreen}"/>
        <SolidColorBrush x:Key="DarkSoftOrangeBrush" Color="{StaticResource DarkSoftOrange}"/>
        <SolidColorBrush x:Key="DarkChalkboardBrush" Color="{StaticResource DarkChalkboard}"/>
        <SolidColorBrush x:Key="DarkChalkWhiteBrush" Color="{StaticResource DarkChalkWhite}"/>
        <SolidColorBrush x:Key="DarkSoftBlueBrush" Color="{StaticResource DarkSoftBlue}"/>
        <SolidColorBrush x:Key="DarkPencilYellowBrush" Color="{StaticResource DarkPencilYellow}"/>

        <!-- Default Brushes (will be set based on theme) -->
        <SolidColorBrush x:Key="CreamBackgroundBrush" Color="{StaticResource LightCreamBackground}"/>
        <SolidColorBrush x:Key="PaperWhiteBrush" Color="{StaticResource LightPaperWhite}"/>
        <SolidColorBrush x:Key="MintGreenBrush" Color="{StaticResource LightMintGreen}"/>
        <SolidColorBrush x:Key="LavenderBrush" Color="{StaticResource LightLavender}"/>
        <SolidColorBrush x:Key="SkyBlueBrush" Color="{StaticResource LightSkyBlue}"/>
        <SolidColorBrush x:Key="WarmBrownBrush" Color="{StaticResource LightWarmBrown}"/>
        <SolidColorBrush x:Key="StickyNoteYellowBrush" Color="{StaticResource LightStickyNoteYellow}"/>
        <SolidColorBrush x:Key="SageGreenBrush" Color="{StaticResource LightSageGreen}"/>
        <SolidColorBrush x:Key="SoftOrangeBrush" Color="{StaticResource LightSoftOrange}"/>
        <SolidColorBrush x:Key="ChalkboardBrush" Color="{StaticResource LightChalkboard}"/>
        <SolidColorBrush x:Key="ChalkWhiteBrush" Color="{StaticResource LightChalkWhite}"/>
        <SolidColorBrush x:Key="SoftBlueBrush" Color="{StaticResource LightSoftBlue}"/>
        <SolidColorBrush x:Key="PencilYellowBrush" Color="{StaticResource LightPencilYellow}"/>
        <SolidColorBrush x:Key="SemiTransparentWhiteBrush" Color="{StaticResource SemiTransparentWhite}"/>
        <SolidColorBrush x:Key="SemiTransparentStickyNoteYellowBrush" Color="{StaticResource SemiTransparentStickyNoteYellow}"/>
        <SolidColorBrush x:Key="SemiTransparentLavenderBrush" Color="{StaticResource SemiTransparentLavender}"/>
        <SolidColorBrush x:Key="SemiTransparentCreamBrush" Color="{StaticResource SemiTransparentCream}"/>

        <!-- Notebook Paper Texture -->
        <DrawingBrush x:Key="NotebookPaperTexture" TileMode="Tile" Viewport="0,0,100,100" ViewportUnits="Absolute">
            <DrawingBrush.Drawing>
                <DrawingGroup>
                    <GeometryDrawing Brush="{StaticResource PaperWhiteBrush}">
                        <GeometryDrawing.Geometry>
                            <RectangleGeometry Rect="0,0,100,100"/>
                        </GeometryDrawing.Geometry>
                    </GeometryDrawing>
                    <GeometryDrawing>
                        <GeometryDrawing.Geometry>
                            <RectangleGeometry Rect="0,25,100,0.5"/>
                        </GeometryDrawing.Geometry>
                        <GeometryDrawing.Brush>
                            <SolidColorBrush Color="#FFD0CECE" Opacity="0.5"/>
                        </GeometryDrawing.Brush>
                    </GeometryDrawing>
                    <GeometryDrawing>
                        <GeometryDrawing.Geometry>
                            <RectangleGeometry Rect="0,50,100,0.5"/>
                        </GeometryDrawing.Geometry>
                        <GeometryDrawing.Brush>
                            <SolidColorBrush Color="#FFD0CECE" Opacity="0.5"/>
                        </GeometryDrawing.Brush>
                    </GeometryDrawing>
                    <GeometryDrawing>
                        <GeometryDrawing.Geometry>
                            <RectangleGeometry Rect="0,75,100,0.5"/>
                        </GeometryDrawing.Geometry>
                        <GeometryDrawing.Brush>
                            <SolidColorBrush Color="#FFD0CECE" Opacity="0.5"/>
                        </GeometryDrawing.Brush>
                    </GeometryDrawing>
                    <GeometryDrawing>
                        <GeometryDrawing.Geometry>
                            <RectangleGeometry Rect="15,0,0.5,100"/>
                        </GeometryDrawing.Geometry>
                        <GeometryDrawing.Brush>
                            <SolidColorBrush Color="#FFA8A5A5" Opacity="0.7"/>
                        </GeometryDrawing.Brush>
                    </GeometryDrawing>
                </DrawingGroup>
            </DrawingBrush.Drawing>
        </DrawingBrush>

        <!-- Wood Grain Texture -->
        <DrawingBrush x:Key="WoodGrainTexture" TileMode="Tile" Viewport="0,0,200,200" ViewportUnits="Absolute">
            <DrawingBrush.Drawing>
                <DrawingGroup>
                    <GeometryDrawing Brush="{StaticResource WarmBrownBrush}">
                        <GeometryDrawing.Geometry>
                            <RectangleGeometry Rect="0,0,200,200"/>
                        </GeometryDrawing.Geometry>
                    </GeometryDrawing>
                    <GeometryDrawing>
                        <GeometryDrawing.Geometry>
                            <PathGeometry Figures="M 0,50 Q 50,30 100,50 T 200,50 L 200,60 Q 150,40 100,60 T 0,60 Z"/>
                        </GeometryDrawing.Geometry>
                        <GeometryDrawing.Brush>
                            <SolidColorBrush Color="#FF6B3410" Opacity="0.3"/>
                        </GeometryDrawing.Brush>
                    </GeometryDrawing>
                    <GeometryDrawing>
                        <GeometryDrawing.Geometry>
                            <PathGeometry Figures="M 0,100 Q 50,80 100,100 T 200,100 L 200,110 Q 150,90 100,110 T 0,110 Z"/>
                        </GeometryDrawing.Geometry>
                        <GeometryDrawing.Brush>
                            <SolidColorBrush Color="#FF6B3410" Opacity="0.3"/>
                        </GeometryDrawing.Brush>
                    </GeometryDrawing>
                    <GeometryDrawing>
                        <GeometryDrawing.Geometry>
                            <PathGeometry Figures="M 0,150 Q 50,130 100,150 T 200,150 L 200,160 Q 150,140 100,160 T 0,160 Z"/>
                        </GeometryDrawing.Geometry>
                        <GeometryDrawing.Brush>
                            <SolidColorBrush Color="#FF6B3410" Opacity="0.3"/>
                        </GeometryDrawing.Brush>
                    </GeometryDrawing>
                </DrawingGroup>
            </DrawingBrush.Drawing>
        </DrawingBrush>

        <!-- Sticky Note Style -->
        <Style x:Key="StickyNoteStyle" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource StickyNoteYellowBrush}"/>
            <Setter Property="BorderBrush" Value="#FFE6D690"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="2"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#FFD4AF37" ShadowDepth="3" Direction="315" BlurRadius="5" Opacity="0.5"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Chalkboard Style -->
        <Style x:Key="ChalkboardStyle" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource ChalkboardBrush}"/>
            <Setter Property="BorderBrush" Value="#FF81D4FA"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="CornerRadius" Value="3"/>
            <Setter Property="Padding" Value="15,10"/>
        </Style>

        <!-- Notebook Tab Style - Updated with transparency -->
        <Style x:Key="NotebookTabStyle" TargetType="TabItem">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Grid Name="Panel" Margin="0,0,5,0">
                            <Grid>
                                <Border Name="Border"
                                        Background="{StaticResource SemiTransparentWhiteBrush}"
                                        BorderBrush="{StaticResource SoftBlueBrush}"
                                        BorderThickness="1,1,1,0"
                                        CornerRadius="8,8,0,0"
                                        Padding="15,8"
                                        Height="45">
                                    <Border.Effect>
                                        <DropShadowEffect Color="#FF87CEEB" 
                                                          ShadowDepth="2" 
                                                          Direction="315" 
                                                          BlurRadius="4" 
                                                          Opacity="0.3"/>
                                    </Border.Effect>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                                            <TextBlock x:Name="TabText" 
                                                       Text="{TemplateBinding Header}" 
                                                       VerticalAlignment="Center" 
                                                       FontWeight="Medium"
                                                       FontFamily="Comic Neue, Kalam"
                                                       FontSize="14"
                                                       Foreground="{StaticResource SoftBlueBrush}"/>
                                            <TextBlock x:Name="ModifiedIndicator" 
                                                       Text=" *" 
                                                       VerticalAlignment="Center" 
                                                       FontWeight="Bold"
                                                       FontFamily="Comic Neue, Kalam"
                                                       FontSize="14"
                                                       Foreground="{StaticResource SoftOrangeBrush}"
                                                       Visibility="Collapsed"/>
                                        </StackPanel>
                                        <Button x:Name="CloseButton"
                                                Grid.Column="1"
                                                Content="✕" 
                                                Width="20" 
                                                Height="20" 
                                                Margin="8,0,0,0"
                                                VerticalAlignment="Center"
                                                Background="Transparent" 
                                                BorderThickness="0"
                                                Foreground="{StaticResource SoftBlueBrush}"
                                                FontSize="10"
                                                FontWeight="Bold"
                                                Cursor="Hand"
                                                ToolTip="Close tab">
                                            <Button.Style>
                                                <Style TargetType="Button">
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="Button">
                                                                <Border Background="{TemplateBinding Background}"
                                                                        CornerRadius="10">
                                                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                </Border>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background" Value="{StaticResource SoftOrangeBrush}"/>
                                                            <Setter Property="Foreground" Value="White"/>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                        </Button>
                                    </Grid>
                                </Border>
                                <!-- Torn edge effect -->
                                <Path Grid.ZIndex="-1" 
                                      Data="M 0,45 Q 5,40 10,45 T 20,45 T 30,45 T 40,45 T 50,45 T 60,45 T 70,45 T 80,45 T 90,45 T 100,45 T 110,45 T 120,45 T 130,45 T 140,45 T 150,45 T 160,45 T 170,45 T 180,45 T 190,45 T 200,45" 
                                      Stroke="{StaticResource SoftBlueBrush}" 
                                      StrokeThickness="1" 
                                      Fill="Transparent" 
                                      VerticalAlignment="Bottom" 
                                      Margin="0,0,0,-1"/>
                            </Grid>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="{StaticResource SemiTransparentStickyNoteYellowBrush}"/>
                                <Setter TargetName="Border" Property="BorderThickness" Value="1,1,1,0"/>
                                <Setter TargetName="TabText" Property="Foreground" Value="{StaticResource SoftBlueBrush}"/>
                                <Setter TargetName="TabText" Property="FontWeight" Value="Bold"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="{StaticResource SemiTransparentLavenderBrush}"/>
                                <Setter TargetName="CloseButton" Property="Foreground" Value="{StaticResource SoftBlueBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- TabControl Style - Updated with transparency -->
        <Style TargetType="TabControl">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabControl">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <!-- Tabs Container - Semi-transparent -->
                            <Border Grid.Row="0" 
                                    Background="{StaticResource SemiTransparentWhiteBrush}"
                                    BorderBrush="{StaticResource SkyBlueBrush}"
                                    BorderThickness="0,0,0,2"
                                    Padding="10,5"
                                    CornerRadius="0,0,0,0">
                                <TabPanel x:Name="HeaderPanel"
                                          IsItemsHost="True"
                                          Background="Transparent"
                                          Margin="0,0,0,0"/>
                            </Border>
                            <!-- Tab Content -->
                            <Border Grid.Row="1" 
                                    Background="{StaticResource SemiTransparentCreamBrush}"
                                    BorderBrush="{StaticResource SkyBlueBrush}"
                                    BorderThickness="2"
                                    CornerRadius="0,12,12,12"
                                    Padding="5">
                                <Border.Effect>
                                    <DropShadowEffect Color="#FF87CEEB" 
                                                      ShadowDepth="3" 
                                                      Direction="315" 
                                                      BlurRadius="8" 
                                                      Opacity="0.2"/>
                                </Border.Effect>
                                <ContentPresenter ContentSource="SelectedContent"/>
                            </Border>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Button Styles -->
        <Style x:Key="ClassroomButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource SkyBlueBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource SoftBlueBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource SageGreenBrush}"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontFamily" Value="Comic Neue, Kalam"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="12"
                                Padding="{TemplateBinding Padding}">
                            <Border.Effect>
                                <DropShadowEffect Color="#FF87CEEB" 
                                                  ShadowDepth="2" 
                                                  Direction="315" 
                                                  BlurRadius="5" 
                                                  Opacity="0.3"/>
                            </Border.Effect>
                            <Grid>
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource LavenderBrush}"/>
                                <Setter Property="BorderBrush" Value="{StaticResource SkyBlueBrush}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="{StaticResource SoftOrangeBrush}"/>
                                <Setter Property="BorderBrush" Value="{StaticResource SkyBlueBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Action Button Style (Run, Save, etc.) -->
        <Style x:Key="ClassroomActionButton" TargetType="Button" BasedOn="{StaticResource ClassroomButton}">
            <Setter Property="Background" Value="{StaticResource StickyNoteYellowBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource SkyBlueBrush}"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Padding" Value="15,8"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{StaticResource SoftOrangeBrush}"/>
                    <Setter Property="BorderBrush" Value="{StaticResource SkyBlueBrush}"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="{StaticResource SkyBlueBrush}"/>
                    <Setter Property="BorderBrush" Value="{StaticResource SoftBlueBrush}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Copy Button Style -->
        <Style x:Key="CopyButtonStyle" TargetType="Button" BasedOn="{StaticResource ClassroomButton}">
            <Setter Property="Background" Value="{StaticResource LavenderBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource SkyBlueBrush}"/>
            <Setter Property="Width" Value="36"/>
            <Setter Property="Height" Value="36"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Margin" Value="5,0"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{StaticResource SkyBlueBrush}"/>
                    <Setter Property="BorderBrush" Value="{StaticResource SoftBlueBrush}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- TextBox Style -->
        <Style TargetType="TextBox">
            <Setter Property="Background" Value="{StaticResource PaperWhiteBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource SkyBlueBrush}"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontFamily" Value="Consolas, 'Courier New'"/>
            <Setter Property="Foreground" Value="{StaticResource SoftBlueBrush}"/>
            <Setter Property="SelectionBrush" Value="{StaticResource SkyBlueBrush}"/>
            <Setter Property="CaretBrush" Value="{StaticResource SoftBlueBrush}"/>
            <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
            <Setter Property="TextWrapping" Value="NoWrap"/>
            <Setter Property="AcceptsReturn" Value="True"/>
            <Setter Property="AcceptsTab" Value="True"/>
            <Style.Triggers>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="{StaticResource SkyBlueBrush}"/>
                    <Setter Property="BorderThickness" Value="3"/>
                    <Setter Property="Effect">
                        <Setter.Value>
                            <DropShadowEffect Color="#FF87CEEB" 
                                              ShadowDepth="0" 
                                              BlurRadius="8" 
                                              Opacity="0.3"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="BorderBrush" Value="{StaticResource LavenderBrush}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Console Output Style -->
        <Style x:Key="ConsoleOutputStyle" TargetType="TextBox" BasedOn="{StaticResource {x:Type TextBox}}">
            <Setter Property="Background" Value="{StaticResource StickyNoteYellowBrush}"/>
            <Setter Property="BorderBrush" Value="#FFE6D690"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Foreground" Value="{StaticResource SoftBlueBrush}"/>
            <Setter Property="FontFamily" Value="Consolas, 'Courier New'"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
            <Setter Property="HorizontalScrollBarVisibility" Value="Auto"/>
            <Setter Property="IsReadOnly" Value="True"/>
            <Style.Triggers>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="{StaticResource SoftOrangeBrush}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Code Editor Style -->
        <Style x:Key="CodeEditorStyle" TargetType="TextBox" BasedOn="{StaticResource {x:Type TextBox}}">
            <Setter Property="Background" Value="{StaticResource NotebookPaperTexture}"/>
            <Setter Property="BorderBrush" Value="{StaticResource SkyBlueBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Foreground" Value="{StaticResource SoftBlueBrush}"/>
            <Setter Property="FontFamily" Value="Consolas, 'Courier New'"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="20,5,5,5"/>
            <Setter Property="TextWrapping" Value="NoWrap"/>
            <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
            <Setter Property="HorizontalScrollBarVisibility" Value="Auto"/>
            <Setter Property="AcceptsReturn" Value="True"/>
            <Setter Property="AcceptsTab" Value="True"/>
            <Setter Property="SelectionBrush" Value="{StaticResource SkyBlueBrush}"/>
            <Setter Property="CaretBrush" Value="{StaticResource SoftBlueBrush}"/>
            <Style.Triggers>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="{StaticResource SkyBlueBrush}"/>
                    <Setter Property="Effect">
                        <Setter.Value>
                            <DropShadowEffect Color="#FF87CEEB" 
                                              ShadowDepth="0" 
                                              BlurRadius="8" 
                                              Opacity="0.3"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- GridSplitter Style -->
        <Style TargetType="GridSplitter">
            <Setter Property="Background" Value="{StaticResource SkyBlueBrush}"/>
            <Setter Property="Width" Value="8"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{StaticResource SoftOrangeBrush}"/>
                    <Setter Property="Effect">
                        <Setter.Value>
                            <DropShadowEffect Color="#FFFFD4A3" 
                                              ShadowDepth="0" 
                                              BlurRadius="8" 
                                              Opacity="0.5"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Title Style -->
        <Style x:Key="ClassroomTitle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Kalam, Comic Neue"/>
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="{StaticResource SoftBlueBrush}"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#FF87CEEB" 
                                      ShadowDepth="2" 
                                      Direction="315" 
                                      BlurRadius="5" 
                                      Opacity="0.5"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Subtitle Style -->
        <Style x:Key="ClassroomSubtitle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Kalam, Comic Neue"/>
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="FontStyle" Value="Italic"/>
            <Setter Property="Foreground" Value="{StaticResource SoftBlueBrush}"/>
            <Setter Property="Margin" Value="5,0,0,0"/>
        </Style>

        <!-- StatusBar Style -->
        <Style x:Key="ClassroomStatusBar" TargetType="StatusBar">
            <Setter Property="Background" Value="{StaticResource SemiTransparentWhiteBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource SoftBlueBrush}"/>
        </Style>

        <!-- Cherry Blossom Petal Animation -->
        <Storyboard x:Key="PetalFallAnimation" RepeatBehavior="Forever">
            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)">
                <EasingDoubleKeyFrame KeyTime="0:0:0" Value="-20"/>
                <EasingDoubleKeyFrame KeyTime="0:0:10" Value="820"/>
            </DoubleAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)">
                <EasingDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                <EasingDoubleKeyFrame KeyTime="0:0:5" Value="50"/>
                <EasingDoubleKeyFrame KeyTime="0:0:10" Value="100"/>
            </DoubleAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(RotateTransform.Angle)">
                <EasingDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                <EasingDoubleKeyFrame KeyTime="0:0:10" Value="360"/>
            </DoubleAnimationUsingKeyFrames>
            <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0.8" To="0" Duration="0:0:10"/>
        </Storyboard>

        <!-- Cherry Blossom Petal Template -->
        <ControlTemplate x:Key="CherryBlossomPetal" TargetType="ContentControl">
            <Grid>
                <Path Data="M 0,0 C 5,-10 15,-10 20,0 C 15,5 5,5 0,0 Z" 
                      Fill="#FFFFB7C5" 
                      Stretch="Uniform"
                      Width="20" 
                      Height="20"
                      RenderTransformOrigin="0.5,0.5">
                    <Path.RenderTransform>
                        <TransformGroup>
                            <RotateTransform/>
                            <TranslateTransform/>
                        </TransformGroup>
                    </Path.RenderTransform>
                </Path>
            </Grid>
        </ControlTemplate>
    </Window.Resources>

    <!-- Main Container with Anime Classroom Theme -->
    <Grid>
        <!-- Background -->
        <Rectangle Fill="{StaticResource CreamBackgroundBrush}"/>
        <!-- Background Image -->
        <Rectangle x:Name="ImageBackground">
            <Rectangle.Fill>
                <ImageBrush x:Name="BackgroundImageBrush" Stretch="UniformToFill" Opacity="0.2"/>
            </Rectangle.Fill>
        </Rectangle>
        <!-- Floating Cherry Blossom Petals -->
        <ContentControl Template="{StaticResource CherryBlossomPetal}" 
                        HorizontalAlignment="Left" 
                        VerticalAlignment="Top" 
                        Margin="100,0,0,0"
                        RenderTransformOrigin="0.5,0.5">
            <ContentControl.Triggers>
                <EventTrigger RoutedEvent="Loaded">
                    <BeginStoryboard Storyboard="{StaticResource PetalFallAnimation}"/>
                </EventTrigger>
            </ContentControl.Triggers>
        </ContentControl>
        <ContentControl Template="{StaticResource CherryBlossomPetal}" 
                        HorizontalAlignment="Left" 
                        VerticalAlignment="Top" 
                        Margin="300,0,0,0"
                        RenderTransformOrigin="0.5,0.5">
            <ContentControl.Triggers>
                <EventTrigger RoutedEvent="Loaded">
                    <BeginStoryboard Storyboard="{StaticResource PetalFallAnimation}"/>
                </EventTrigger>
            </ContentControl.Triggers>
        </ContentControl>
        <ContentControl Template="{StaticResource CherryBlossomPetal}" 
                        HorizontalAlignment="Left" 
                        VerticalAlignment="Top" 
                        Margin="500,0,0,0"
                        RenderTransformOrigin="0.5,0.5">
            <ContentControl.Triggers>
                <EventTrigger RoutedEvent="Loaded">
                    <BeginStoryboard Storyboard="{StaticResource PetalFallAnimation}"/>
                </EventTrigger>
            </ContentControl.Triggers>
        </ContentControl>
        <ContentControl Template="{StaticResource CherryBlossomPetal}" 
                        HorizontalAlignment="Left" 
                        VerticalAlignment="Top" 
                        Margin="700,0,0,0"
                        RenderTransformOrigin="0.5,0.5">
            <ContentControl.Triggers>
                <EventTrigger RoutedEvent="Loaded">
                    <BeginStoryboard Storyboard="{StaticResource PetalFallAnimation}"/>
                </EventTrigger>
            </ContentControl.Triggers>
        </ContentControl>
        <ContentControl Template="{StaticResource CherryBlossomPetal}" 
                        HorizontalAlignment="Left" 
                        VerticalAlignment="Top" 
                        Margin="900,0,0,0"
                        RenderTransformOrigin="0.5,0.5">
            <ContentControl.Triggers>
                <EventTrigger RoutedEvent="Loaded">
                    <BeginStoryboard Storyboard="{StaticResource PetalFallAnimation}"/>
                </EventTrigger>
            </ContentControl.Triggers>
        </ContentControl>
        <!-- Classroom Style Border -->
        <Border BorderBrush="{StaticResource SkyBlueBrush}" 
                BorderThickness="5" 
                Margin="10"
                Background="Transparent"
                CornerRadius="15">
            <Border.Effect>
                <DropShadowEffect Color="#FF87CEEB" 
                                  ShadowDepth="5" 
                                  Direction="315" 
                                  BlurRadius="12" 
                                  Opacity="0.3"/>
            </Border.Effect>
            <Grid>
                <!-- Custom Title Bar -->
                <Grid.RowDefinitions>
                    <RowDefinition Height="60"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="40"/>
                </Grid.RowDefinitions>
                <!-- Title Bar with Chalkboard Style -->
                <Border Grid.Row="0" 
                        Style="{StaticResource ChalkboardStyle}"
                        MouseLeftButtonDown="TitleBar_MouseLeftButtonDown"
                        CornerRadius="8,8,0,0">
                    <Border.Effect>
                        <DropShadowEffect Color="#FF87CEEB" 
                                          ShadowDepth="2" 
                                          Direction="315" 
                                          BlurRadius="6" 
                                          Opacity="0.2"/>
                    </Border.Effect>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <!-- App Title with Classroom Font -->
                        <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="R Classroom"
                                       Style="{StaticResource ClassroomTitle}"
                                       Margin="15,0,0,0"
                                       VerticalAlignment="Center"
                                       Foreground="{StaticResource StickyNoteYellowBrush}"/>
                            <TextBlock Text=" - by prasannova solutions"
                                       Style="{StaticResource ClassroomSubtitle}"
                                       Margin="6,0,0,0"
                                       VerticalAlignment="Center"
                                       TextWrapping="NoWrap"/>
                        </StackPanel>

                        <!-- Window Controls -->
                        <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button x:Name="MinimizeButton" 
                                    Content="−" 
                                    Style="{StaticResource ClassroomButton}"
                                    Width="40" 
                                    Height="40" 
                                    Margin="0,5,5,5" 
                                    Click="MinimizeButton_Click"
                                    ToolTip="Minimize"/>
                            <Button x:Name="MaximizeButton" 
                                    Content="□" 
                                    Style="{StaticResource ClassroomButton}"
                                    Width="40" 
                                    Height="40" 
                                    Margin="0,5,5,5" 
                                    Click="MaximizeButton_Click"
                                    ToolTip="Maximize"/>
                            <Button x:Name="CloseButton" 
                                    Content="✕" 
                                    Style="{StaticResource ClassroomButton}"
                                    Width="40" 
                                    Height="40" 
                                    Margin="0,5,10,5" 
                                    Click="CloseButton_Click"
                                    ToolTip="Close"/>
                        </StackPanel>
                    </Grid>
                </Border>
                <!-- Main Content Area -->
                <Grid Grid.Row="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <!-- Toolbar with Semi-transparent Style -->
                    <Border Grid.Row="0" 
                            Background="{StaticResource SemiTransparentWhiteBrush}"
                            BorderBrush="{StaticResource SkyBlueBrush}" 
                            BorderThickness="0,0,0,3"
                            Margin="10,0,10,5"
                            CornerRadius="0,0,12,12">
                        <Border.Effect>
                            <DropShadowEffect Color="#FF87CEEB" 
                                              ShadowDepth="2" 
                                              Direction="315" 
                                              BlurRadius="6" 
                                              Opacity="0.2"/>
                        </Border.Effect>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <!-- Left Button Group -->
                            <StackPanel Grid.Column="0" Orientation="Horizontal" Height="50">
                                <Button x:Name="NewTabButton" 
                                        Style="{StaticResource ClassroomButton}"
                                        Margin="10,5,5,5" 
                                        Padding="15,0" 
                                        Click="NewTabButton_Click"
                                        ToolTip="Create a new tab">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="📝" FontSize="16" Margin="0,0,5,0"/>
                                        <TextBlock Text="NEW TAB"/>
                                    </StackPanel>
                                </Button>
                                <Button x:Name="SaveButton" 
                                        Style="{StaticResource ClassroomButton}"
                                        Margin="5" 
                                        Padding="15,0" 
                                        Click="SaveButton_Click"
                                        ToolTip="Save current file">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="✏️" FontSize="16" Margin="0,0,5,0"/>
                                        <TextBlock Text="SAVE"/>
                                    </StackPanel>
                                </Button>
                                <Button x:Name="LoadButton" 
                                        Style="{StaticResource ClassroomButton}"
                                        Margin="5" 
                                        Padding="15,0" 
                                        Click="LoadButton_Click"
                                        ToolTip="Load a file">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="📁" FontSize="16" Margin="0,0,5,0"/>
                                        <TextBlock Text="LOAD"/>
                                    </StackPanel>
                                </Button>
                                <Separator Margin="10,5" Width="3" Background="{StaticResource SkyBlueBrush}"/>
                                <Button x:Name="RunButton" 
                                        Style="{StaticResource ClassroomActionButton}"
                                        Margin="5" 
                                        Padding="15,0" 
                                        Click="RunButton_Click"
                                        ToolTip="Execute R code">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="🍎" FontSize="16" Margin="0,0,5,0"/>
                                        <TextBlock Text="RUN (F5)"/>
                                    </StackPanel>
                                </Button>
                                <Button x:Name="ClearButton" 
                                        Style="{StaticResource ClassroomButton}"
                                        Margin="5" 
                                        Padding="15,0" 
                                        Click="ClearButton_Click"
                                        ToolTip="Clear output console">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="🧹" FontSize="16" Margin="0,0,5,0"/>
                                        <TextBlock Text="CLEAR OUTPUT"/>
                                    </StackPanel>
                                </Button>
                            </StackPanel>
                            <!-- Right Button Group -->
                            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                <Button x:Name="SettingsButton" 
                                        Style="{StaticResource ClassroomButton}"
                                        Margin="5" 
                                        Padding="15,0" 
                                        Click="SettingsButton_Click"
                                        ToolTip="Configure R executable path">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="⚙️" FontSize="16" Margin="0,0,5,0"/>
                                        <TextBlock Text="R PATH"/>
                                    </StackPanel>
                                </Button>
                                <Button x:Name="ThemeSettingsButton" 
                                        Style="{StaticResource ClassroomButton}"
                                        Margin="5" 
                                        Padding="15,0" 
                                        Click="ThemeSettingsButton_Click"
                                        ToolTip="Customize application theme">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="🎨" FontSize="16" Margin="0,0,5,0"/>
                                        <TextBlock Text="THEME"/>
                                    </StackPanel>
                                </Button>
                                <Button x:Name="BackgroundSettingsButton" 
                                        Style="{StaticResource ClassroomButton}"
                                        Margin="5,5,10,5" 
                                        Padding="15,0" 
                                        Click="BackgroundSettingsButton_Click"
                                        ToolTip="Change application background">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="🖼️" FontSize="16" Margin="0,0,5,0"/>
                                        <TextBlock Text="BACKGROUND"/>
                                    </StackPanel>
                                </Button>
                                <!-- Theme Toggle Button -->
                                <Button x:Name="ThemeToggleButton" 
        Style="{StaticResource ClassroomButton}"
        Margin="5,5,10,5" 
        Padding="15,0" 
        Click="ThemeToggleButton_Click"
        ToolTip="Toggle between light and dark theme">
                                    <TextBlock x:Name="ThemeIcon" Text="🌙" FontSize="16"/>
                                </Button>
                            </StackPanel>
                        </Grid>
                    </Border>
                    <!-- Code Editor and Output Area -->
                    <Grid Grid.Row="1" Margin="10,5,10,10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <!-- Notebook Style Tabs -->
                        <TabControl x:Name="CodeTabsTabControl" 
                                    Grid.Row="0"
                                    Style="{StaticResource {x:Type TabControl}}"
                                    ItemContainerStyle="{StaticResource NotebookTabStyle}"
                                    SelectionChanged="CodeTabsTabControl_SelectionChanged">
                            <TabControl.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Header}" FontWeight="Medium"/>
                                </DataTemplate>
                            </TabControl.ItemTemplate>
                        </TabControl>
                        <!-- Code Editor and Output Area -->
                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="8"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <!-- Code Editor Panel with Notebook Paper Style -->
                            <Border x:Name="EditorBorder" Grid.Column="0" 
                                    Background="{StaticResource NotebookPaperTexture}"
                                    BorderBrush="{StaticResource SkyBlueBrush}"
                                    BorderThickness="2"
                                    Margin="0,5,5,0"
                                    CornerRadius="8"
                                    Padding="5">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <!-- Spiral Binding Graphic on Left Side -->
                                    <StackPanel Grid.Row="0" Grid.RowSpan="2" HorizontalAlignment="Left" Margin="5,0,0,0" Orientation="Vertical">
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource SkyBlueBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource SkyBlueBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource SkyBlueBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource SkyBlueBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource SkyBlueBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource SkyBlueBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource SkyBlueBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource SkyBlueBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource SkyBlueBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource SkyBlueBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource SkyBlueBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource SkyBlueBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource SkyBlueBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource SkyBlueBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource SkyBlueBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource SkyBlueBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource SkyBlueBrush}" Margin="0,5"/>
                                    </StackPanel>
                                    <!-- Copy Code Button -->
                                    <Button Grid.Row="0" 
                                            Style="{StaticResource CopyButtonStyle}"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Top"
                                            Click="CopyCodeButton_Click"
                                            ToolTip="Copy Code">
                                        <TextBlock Text="📎" FontSize="18"/>
                                    </Button>
                                    <!-- Code Editor with Line Numbers -->
                                    <local:CodeEditorWithLineNumbers x:Name="CodeEditor" 
                                                                     Grid.Row="1" 
                                                                     Margin="25,5,5,5"/>
                                </Grid>
                            </Border>
                            <!-- Splitter -->
                            <GridSplitter Grid.Column="1" 
                                          HorizontalAlignment="Stretch" 
                                          VerticalAlignment="Stretch" 
                                          Background="{StaticResource SkyBlueBrush}"
                                          Margin="0,8"/>
                            <!-- Output Panel with Sticky Note Style -->
                            <Border x:Name="OutputBorder" Grid.Column="2" 
                                    Style="{StaticResource StickyNoteStyle}"
                                    Margin="5,5,0,0">
                                <TabControl x:Name="OutputTabControl">
                                    <TabItem Header="CONSOLE">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="*"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <TextBox x:Name="OutputDisplay" 
                                                     Grid.Row="0" 
                                                     Style="{StaticResource ConsoleOutputStyle}"
                                                     Margin="5"/>
                                            <StackPanel Grid.Row="1" 
                                                        Orientation="Horizontal" 
                                                        HorizontalAlignment="Right" 
                                                        Margin="5">
                                                <Button Content="SAVE OUTPUT" 
                                                        Style="{StaticResource ClassroomButton}"
                                                        Margin="5" 
                                                        Padding="15,0" 
                                                        Click="SaveOutputButton_Click"
                                                        ToolTip="Save console output"/>
                                                <Button Style="{StaticResource CopyButtonStyle}"
                                                        Click="CopyErrorsButton_Click"
                                                        ToolTip="Copy Errors">
                                                    <TextBlock Text="📝" FontSize="18"/>
                                                </Button>
                                            </StackPanel>
                                        </Grid>
                                    </TabItem>
                                    <TabItem Header="PLOT">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="*"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <ScrollViewer Grid.Row="0" 
                                                          HorizontalScrollBarVisibility="Auto" 
                                                          VerticalScrollBarVisibility="Auto"
                                                          Margin="5">
                                                <Image x:Name="PlotDisplay" 
                                                       Stretch="Uniform"
                                                       RenderOptions.BitmapScalingMode="HighQuality"/>
                                            </ScrollViewer>
                                            <StackPanel Grid.Row="1" 
                                                        Orientation="Horizontal" 
                                                        HorizontalAlignment="Right" 
                                                        Margin="5">
                                                <Button Content="ZOOM IN" 
                                                        Style="{StaticResource ClassroomButton}"
                                                        Margin="5" 
                                                        Padding="15,0" 
                                                        Click="ZoomInPlotButton_Click"
                                                        ToolTip="Zoom in the plot"/>
                                                <Button Content="ZOOM OUT" 
                                                        Style="{StaticResource ClassroomButton}"
                                                        Margin="5" 
                                                        Padding="15,0" 
                                                        Click="ZoomOutPlotButton_Click"
                                                        ToolTip="Zoom out the plot"/>
                                                <Button Content="SAVE PLOT" 
                                                        Style="{StaticResource ClassroomButton}"
                                                        Margin="5" 
                                                        Padding="15,0" 
                                                        Click="SavePlotButton_Click"
                                                        ToolTip="Save plot as image"/>
                                                <Button Content="CLEAR PLOT" 
                                                        Style="{StaticResource ClassroomButton}"
                                                        Margin="5,5,10,5" 
                                                        Padding="15,0" 
                                                        Click="ClearPlotButton_Click"
                                                        ToolTip="Clear current plot"/>
                                            </StackPanel>
                                        </Grid>
                                    </TabItem>
                                    <!-- New AI Assistant Tab -->
                                    <TabItem Header="AI ASSISTANT">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="*"/>
                                            </Grid.RowDefinitions>
                                            <!-- AI Service Selection -->
                                            <StackPanel Grid.Row="0" 
                                                        Orientation="Horizontal" 
                                                        Margin="10">
                                                <TextBlock Text="Select AI Service:" 
                                                           VerticalAlignment="Center" 
                                                           Margin="0,0,10,0"
                                                           FontFamily="Comic Neue, Kalam"
                                                           FontWeight="Medium"/>
                                                <RadioButton x:Name="ChatGptRadioButton" 
                                                             Content="ChatGPT" 
                                                             GroupName="AIService" 
                                                             IsChecked="True"
                                                             FontFamily="Comic Neue, Kalam"
                                                             Margin="0,0,10,0"
                                                             Checked="AIServiceRadioButton_Checked"/>
                                                <RadioButton x:Name="ClaudeRadioButton" 
                                                             Content="Claude" 
                                                             GroupName="AIService" 
                                                             FontFamily="Comic Neue, Kalam"
                                                             Margin="0,0,10,0"
                                                             Checked="AIServiceRadioButton_Checked"/>
                                            </StackPanel>
                                            <!-- WebView2 Control for AI Assistant -->
                                            <wpf:WebView2 x:Name="AIWebView" 
                                                          Grid.Row="1" 
                                                          Margin="10"/>
                                        </Grid>
                                    </TabItem>
                                </TabControl>
                            </Border>
                        </Grid>
                    </Grid>
                </Grid>
                <!-- Status Bar with Semi-transparent Style -->
                <Grid Grid.Row="2">
                    <Border Background="{StaticResource SemiTransparentWhiteBrush}"
                            BorderBrush="{StaticResource SkyBlueBrush}" 
                            BorderThickness="0,3,0,0"
                            Margin="10,5,10,0"
                            CornerRadius="12,12,0,0">
                        <Border.Effect>
                            <DropShadowEffect Color="#FF87CEEB" 
                                              ShadowDepth="2" 
                                              Direction="315" 
                                              BlurRadius="6" 
                                              Opacity="0.2"/>
                        </Border.Effect>
                        <StatusBar Style="{StaticResource ClassroomStatusBar}">
                            <StatusBarItem>
                                <TextBlock x:Name="StatusText" 
                                           Text="READY" 
                                           FontWeight="Medium"
                                           FontFamily="Comic Neue, Kalam"/>
                            </StatusBarItem>
                            <Separator Background="{StaticResource SkyBlueBrush}"/>
                            <StatusBarItem>
                                <TextBlock x:Name="ExecutionStatus" 
                                           Text="IDLE" 
                                           FontWeight="Medium"
                                           FontFamily="Comic Neue, Kalam"/>
                            </StatusBarItem>
                            <Separator Background="{StaticResource SkyBlueBrush}"/>
                            <StatusBarItem>
                                <TextBlock x:Name="SessionStatus" 
                                           Text="SESSION SAVED" 
                                           FontWeight="Medium"
                                           FontFamily="Comic Neue, Kalam"/>
                            </StatusBarItem>
                            <Separator Background="{StaticResource SkyBlueBrush}"/>
                            <StatusBarItem>
                                <TextBlock x:Name="LineColumnIndicator" 
                                           Text="LINE: 1, COLUMN: 1" 
                                           FontWeight="Medium"
                                           FontFamily="Comic Neue, Kalam"/>
                            </StatusBarItem>
                            <Separator Background="{StaticResource SkyBlueBrush}"/>
                            <StatusBarItem>
                                <TextBlock x:Name="RPathStatus" 
                                           Text="R PATH: NOT CONFIGURED" 
                                           FontWeight="Medium"
                                           FontFamily="Comic Neue, Kalam"/>
                            </StatusBarItem>
                        </StatusBar>
                    </Border>
                </Grid>
                <!-- Classroom Doodles in Corners -->
                <Canvas Grid.Row="1" IsHitTestVisible="False">
                    <!-- Top Left Corner - Stars -->
                    <Grid Canvas.Left="20" Canvas.Top="20">
                        <Path Data="M 10,10 L 12,16 L 18,16 L 13,20 L 15,26 L 10,22 L 5,26 L 7,20 L 2,16 L 8,16 Z" 
                              Fill="#FFF9A825" 
                              Width="20" 
                              Height="20"/>
                    </Grid>
                    <Grid Canvas.Left="50" Canvas.Top="40">
                        <Path Data="M 40,30 L 42,36 L 48,36 L 43,40 L 45,46 L 40,42 L 35,46 L 37,40 L 32,36 L 38,36 Z" 
                              Fill="#FFF9A825" 
                              Width="20" 
                              Height="20"/>
                    </Grid>
                    <!-- Top Right Corner - Simple Drawing -->
                    <Grid Canvas.Right="40" Canvas.Top="30">
                        <Path Data="M 0,0 Q 10,20 20,0 T 40,0" 
                              Stroke="{StaticResource SkyBlueBrush}" 
                              StrokeThickness="2" 
                              Fill="Transparent" 
                              Width="40" 
                              Height="20"/>
                    </Grid>
                    <!-- Bottom Left Corner - Pencil -->
                    <Grid Canvas.Left="30" Canvas.Bottom="30">
                        <Grid>
                            <Path Data="M 0,0 L 0,30 L 5,35 L 10,30 L 10,0 Z" 
                                  Fill="{StaticResource PencilYellowBrush}" 
                                  Stroke="{StaticResource SkyBlueBrush}" 
                                  StrokeThickness="1" 
                                  Width="10" 
                                  Height="35"/>
                            <Path Data="M 0,0 L 10,0 L 5,5 Z" 
                                  Fill="#FFEC407A" 
                                  Width="10" 
                                  Height="5" 
                                  Margin="0,35,0,0"/>
                        </Grid>
                    </Grid>
                    <!-- Bottom Right Corner - Eraser -->
                    <Grid Canvas.Right="30" Canvas.Bottom="30">
                        <Grid>
                            <Rectangle Fill="#FFE57373" 
                                       Width="20" 
                                       Height="15" 
                                       RadiusX="3" 
                                       RadiusY="3"/>
                            <Rectangle Fill="#FF8D6E63" 
                                       Width="20" 
                                       Height="5" 
                                       Margin="0,15,0,0"/>
                        </Grid>
                    </Grid>
                </Canvas>
            </Grid>
        </Border>
    </Grid>
</Window>